<div id="resultContainer">
    <div id="albumContainer">
        <% results.forEach(result => { %>
            <div class="result <%- result.matched ? 'matched' : 'unmatched' %>">
                <img class="cover spotify" src="<%= result.image %>" alt="">
                <% if (result.matched) { %>
                    <img class="cover subsonic half-cut" src="/coverArt.png?id=<%= result.matched.coverArt %>" alt="">
                <% } %>
                <div class="overlay">
                    <div class="overlayText">
                        <div class="albumTitle"><%= result.albumName %></div>
                        <% if (result.matched) { %>
                            <% if (result.matched.album.toLowerCase() != result.albumName.toLowerCase() ) { %>
                                <%= result.matched.album %>
                            <% }
                        } %>
                        <div class="albumLinks">
                            <a class="spotify" target="_blank" href="https://open.spotify.com/album/<%= result.albumID %>">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M17.9 10.9C14.7 9 9.35 8.8 6.3 9.75c-.5.15-1-.15-1.15-.6c-.15-.5.15-1 .6-1.15c3.55-1.05 9.4-.85 13.1 1.35c.45.25.6.85.35 1.3c-.25.35-.85.5-1.3.25m-.1 2.8c-.25.35-.7.5-1.05.25c-2.7-1.65-6.8-2.15-9.95-1.15c-.4.1-.85-.1-.95-.5c-.1-.4.1-.85.5-.95c3.65-1.1 8.15-.55 11.25 1.35c.3.15.45.65.2 1m-1.2 2.75c-.2.3-.55.4-.85.2c-2.35-1.45-5.3-1.75-8.8-.95c-.35.1-.65-.15-.75-.45c-.1-.35.15-.65.45-.75c3.8-.85 7.1-.5 9.7 1.1c.35.15.4.55.25.85M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>
                                <%= result.albumTotal %>
                            </a>
                            <% if (result.matched) { %>
                                <a class="subsonic" target="_blank" href="<%= domain %>app/#/album/<%= result.matched.id %>/show">
                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20" id="Layer_1" x="0" y="0" version="1.1" viewBox="0 0 512 512" xml:space="preserve" style="enable-background:new 0 0 512 512"><path style="fill:#0084ff" d="M256,10.449C120.275,10.449,10.449,120.276,10.449,256c0,135.725,109.826,245.551,245.551,245.551	S501.551,391.725,501.551,256C501.551,120.276,391.725,10.449,256,10.449z"/><path style="fill:#fff" d="M256,168.229c-48.515,0-87.771,39.257-87.771,87.771s39.257,87.771,87.771,87.771	s87.771-39.257,87.771-87.771S304.515,168.229,256,168.229z"/><path d="M437.061,74.94C388.735,26.615,324.434,0,256,0S123.265,26.615,74.939,74.94S0,187.566,0,256s26.614,132.735,74.939,181.061	S187.566,512,256,512s132.735-26.614,181.061-74.939S512,324.434,512,256S485.386,123.266,437.061,74.94z M256,491.102	C126.365,491.102,20.898,385.635,20.898,256S126.365,20.898,256,20.898S491.102,126.365,491.102,256S385.635,491.102,256,491.102z"/><path d="M354.22,256c0-54.158-44.061-98.22-98.22-98.22s-98.22,44.062-98.22,98.22s44.062,98.22,98.22,98.22	S354.22,310.159,354.22,256z M178.678,256c0-42.636,34.686-77.322,77.322-77.322s77.322,34.686,77.322,77.322	S298.636,333.322,256,333.322S178.678,298.636,178.678,256z"/><path d="M285.257,256c0-16.132-13.124-29.257-29.257-29.257S226.743,239.868,226.743,256s13.125,29.257,29.257,29.257	S285.257,272.133,285.257,256z M247.641,256c0-4.609,3.75-8.359,8.359-8.359c4.609,0,8.359,3.75,8.359,8.359	c0,4.609-3.75,8.359-8.359,8.359C251.391,264.359,247.641,260.609,247.641,256z"/><path d="M256,391.837c-5.771,0-10.449,4.678-10.449,10.449c0,5.771,4.678,10.449,10.449,10.449	c41.897,0,81.265-16.294,110.853-45.883c29.587-29.587,45.881-68.955,45.881-110.852c0-5.771-4.678-10.449-10.449-10.449	c-5.771,0-10.449,4.678-10.449,10.449C391.837,330.9,330.9,391.837,256,391.837z"/><path d="M449.306,245.551c-5.771,0-10.449,4.678-10.449,10.449c0,1.481-0.018,2.958-0.052,4.43	c-0.136,5.769,4.43,10.557,10.199,10.692c0.085,0.002,0.168,0.003,0.252,0.003c5.656,0,10.307-4.517,10.442-10.202	c0.039-1.637,0.059-3.279,0.059-4.925C459.755,250.229,455.077,245.551,449.306,245.551z"/><path d="M447.55,284.239c-5.656-1.145-11.168,2.52-12.308,8.178C418.135,377.271,342.753,438.857,256,438.857	c-5.771,0-10.449,4.678-10.449,10.449c0,5.771,4.678,10.449,10.449,10.449c47.353,0,93.467-16.573,129.847-46.668	c35.9-29.697,60.717-71.084,69.881-116.54C456.868,290.891,453.207,285.38,447.55,284.239z"/><path d="M256,120.163c5.771,0,10.449-4.678,10.449-10.449S261.771,99.265,256,99.265c-41.897,0-81.265,16.294-110.853,45.883	C115.559,174.735,99.265,214.103,99.265,256c0,5.771,4.678,10.449,10.449,10.449s10.449-4.678,10.449-10.449	C120.163,181.1,181.1,120.163,256,120.163z"/><path d="M62.996,240.876c-5.759-0.14-10.557,4.43-10.692,10.199c-0.039,1.637-0.059,3.279-0.059,4.925	c0,5.771,4.678,10.449,10.449,10.449S73.143,261.771,73.143,256c0-1.481,0.018-2.958,0.052-4.43	C73.331,245.8,68.765,241.013,62.996,240.876z"/><path d="M256,73.143c5.771,0,10.449-4.678,10.449-10.449S261.771,52.245,256,52.245c-47.353,0-93.467,16.573-129.847,46.668	c-35.9,29.697-60.717,71.084-69.881,116.54c-1.14,5.657,2.521,11.168,8.178,12.308c0.697,0.141,1.392,0.208,2.076,0.208	c4.872,0,9.232-3.426,10.232-8.386C93.864,134.729,169.247,73.143,256,73.143z"/></svg>
                                    <%= result.matched.songCount %>
                                </a>
                            <% } else { %>
                                <a class="search" target="_blank" href="https://listen.tidal.com/search/albums?q=<%= encodeURIComponent(`${result.albumName} ${result.albumArtist}`) %>">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 256 256"><path fill="currentColor" d="m253.66 90.34l-40-40a8 8 0 0 0-11.32 0L168 84.69l-34.34-34.35a8 8 0 0 0-11.32 0L88 84.69L53.66 50.34a8 8 0 0 0-11.32 0l-40 40a8 8 0 0 0 0 11.32l40 40a8 8 0 0 0 11.32 0L88 107.31L116.69 136l-34.35 34.34a8 8 0 0 0 0 11.32l40 40a8 8 0 0 0 11.32 0l40-40a8 8 0 0 0 0-11.32L139.31 136L168 107.31l34.34 34.35a8 8 0 0 0 11.32 0l40-40a8 8 0 0 0 0-11.32ZM48 124.69L19.31 96L48 67.31L76.69 96Zm80 80L99.31 176L128 147.31L156.69 176Zm0-80L99.31 96L128 67.31L156.69 96Zm80 0L179.31 96L208 67.31L236.69 96Z"/></svg>
                                    Search
                                </a>
                            <% } %>
                        </div>
                    </div>
                </div>
                <div id="icon_<%= result.albumID %>" class="icon <%- result.override ? 'override' : 'default' %>">
                    <div id="symbol_<%= result.albumID %>"><%= result.icon %></div>
                    <select name="statusOverride" album-id="<%= result.albumID %>" class="overrideDropdown" onchange="handleOverride(this)">
                        <option value="unset">-</option>
                        <option value="0">Missing</option>
                        <option value="1">Unconfirmed</option>
                        <option value="2">Track Mismatch</option>
                        <option value="3">Complete</option>
                    </select>
                </div>
            </div>
        <% });%>
    </div>
    <div id="sideContainer">
        <div id="statsContainer">
            <h2>Results for <%= playlistName %></h2>
            <p class="withIcon"><span class="icon">üíø</span><%= results.length %> albums on this page <br/>
                based on <%= itemsPerPage %> tracks (<%= totalTracks %> total)</p>
            <div class="flexList">
                <span>‚úîÔ∏è<%= confirmedCount %> Confirmed on this page</span>
                <span>‚ùî<%= unconfirmedCount %> Unconfirmed on this page</span>
                <span>‚ö†Ô∏è<%= mismatchCount %> With track mismatches on this page</span>
                <span>‚ùå<%= missingCount %> Missing on this page</span>
            </div>
        </div>
        <div class="pagination">
            <p>Page <%= currentPage %> / <%= Math.ceil(totalTracks / itemsPerPage) %></p>
            <% if (currentPage > 1) { %>
                <form action="/" method="GET">
                    <input type="hidden" id="purl" name="playlist" value="<%= locals.purl ? purl : '' %>">
                    <input type="hidden" name="page" value="<%= (currentPage-1) %>">
                    <button type="submit">Previous Page</button>
                </form>
            <% } %>
            <% if (currentPage < Math.ceil(totalTracks / itemsPerPage)) { %>
                <form action="/" method="GET">
                    <input type="hidden" id="purl" name="playlist" value="<%= locals.purl ? purl : '' %>">
                    <input type="hidden" name="page" value="<%= (currentPage+1) %>">
                    <button type="submit">Next Page</button>
                </form>
            <% } %>
        </div>
    </div>

